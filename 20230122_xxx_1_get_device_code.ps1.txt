
$url = "https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode"

$Headers = @{"Host"="login.microsoftonline.com"
"ContentType"="application/x-www-form-urlencoded"
}

$Body=@{
"client_id"="04b07795-8ddb-461a-bbee-02f9e1bf7b46"
"scope"="https://management.core.windows.net//.default"+" offline_access"+" openid"+" profile"
}

$response=Invoke-WebRequest -UseBasicParsing -Uri $url -Method "POST" -Headers $Headers  -Body $Body 
$jsonObj =ConvertFrom-Json $([String]::new($response.Content))
Write-Host $jsonObj
$usercode=$jsonObj.user_code
$global:devicecode=$jsonObj.device_code
Write-Host $usercode















